// Code generated by protoc-gen-go-cel-validate. DO NOT EDIT.
// versions:
//  protoc-gen-go-cel-validate	{{PluginVersion}}
//  protoc						{{ProtocVersion}}
// source: {{.Desc.Path}}

package {{.GoPackageName}}

{{$file := .}}

var (
    _{{.GoDescriptorIdent.GoName}}_rawValidateOptions = []byte{
        {{ range $i, $value := (protoMarshal .Config) -}}
        {{ printf "0x%02x, " $value}}{{- if and $i (mod $i 16) }}{{print "\n"}}{{end}}
        {{- end }}
    }
    _{{.GoDescriptorIdent.GoName}}_validateImports = []{{protoreflect "FileDescriptor"}}{}
)

func init() {
    for i := 0; i < {{.GoDescriptorIdent.GoName}}.Imports().Len(); i++ {
        _{{.GoDescriptorIdent.GoName}}_validateImports = append(_{{.GoDescriptorIdent.GoName}}_validateImports, {{.GoDescriptorIdent.GoName}}.Imports().Get(i))
    }
}


{{ range $s := .Services }}
func New{{.GoName}}ValidateInterceptor(opts ...{{cel "EnvOption"}}) ({{validate "ValidateInterceptor"}}, error) {
    cfg := &{{validate "ValidateOptions"}}{}
    if err := {{proto "Unmarshal"}}(_{{$file.GoDescriptorIdent.GoName}}_rawValidateOptions,cfg); err != nil {
        return nil, err
    }
    if m, err := {{validate "BuildServiceValidateProgram"}}(cfg, {{$file.GoDescriptorIdent.GoName}}.Services().Get({{$s.Desc.Index}}), {{cel "Lib"}}(&{{options "Library"}}{EnvOpts: opts}), _{{$file.GoDescriptorIdent.GoName}}_validateImports...); err != nil {
        return nil, err
    } else {
        return {{validate "NewValidateInterceptor"}}(m), nil
    }
}
{{- end}}

{{range $messageNo,$m := .Messages}}
{{if $m.ContainsValidatePrograms}}
var (
    _{{$.GoDescriptorIdent.GoName}}_{{$m.GoIdent.GoName}}_celValidateMap map[string]*{{validate "Program"}} = nil
	_{{$.GoDescriptorIdent.GoName}}_{{$m.GoIdent.GoName}}_celValidateMapOnce {{sync "Once"}}
)

func (m *{{$m.GoIdent.GoName}}) Validate(ctx {{context "Context"}}, opts ...{{cel "EnvOption"}}) error {
    return m.ValidateWithMask(ctx, &{{fieldmaskpb "FieldMask"}}{
        Paths: []string{"*"},
    })
}

func (m *{{$m.GoIdent.GoName}}) ValidateWithMask(ctx {{context "Context"}}, fm *{{fieldmaskpb "FieldMask"}}, opts ...{{cel "EnvOption"}}) error {
    _{{$.GoDescriptorIdent.GoName}}_{{$m.GoIdent.GoName}}_celValidateMapOnce.Do(func() {
        cfg := &{{validate "ValidateOptions"}}{}
        if err := {{proto "Unmarshal"}}(_{{$file.GoDescriptorIdent.GoName}}_rawValidateOptions,cfg); err != nil {
            return
        }
        m, err := {{validate "BuildMessageValidateProgram"}}(cfg, m.ProtoReflect().Descriptor(), {{cel "Lib"}}(&{{options "Library"}}{EnvOpts: opts}), _{{$file.GoDescriptorIdent.GoName}}_validateImports...); 
        if err == nil {
            _{{$.GoDescriptorIdent.GoName}}_{{$m.GoIdent.GoName}}_celValidateMap = m
        }
    })
    {{- if .Config.RequiredSupportDisabled}}
    return {{validate "ValidateWithMask"}}(ctx, m, fm, _{{$.GoDescriptorIdent.GoName}}_{{$m.GoIdent.GoName}}_celValidateMap, false)
    {{else}}
    return {{validate "ValidateWithMask"}}(ctx, m, fm, _{{$.GoDescriptorIdent.GoName}}_{{$m.GoIdent.GoName}}_celValidateMap, true)
    {{end -}}
}
{{else}}
func (m *{{$m.GoIdent.GoName}}) Validate(ctx {{context "Context"}}) error {
	return nil
}

func (m *{{$m.GoIdent.GoName}}) ValidateWithMask(ctx {{context "Context"}}, fm *{{fieldmaskpb "FieldMask"}}) error {
    return nil
}
{{end}}
{{end}}